<!DOCTYPE html>
<html>

<head>
    <title>European contact tracing mobile apps - Dashboard</title>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta charset="utf-8">
    <meta name="author" content="Alessandro Dalla Benetta, a.dallabenetta@gmail.com">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script src="//cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="scripts/underscore.min.js"></script>

    <script src="//unpkg.com/d3-hexgrid"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="contact_tracing_apps_dashboard/layout.cloud.js"></script>
    <!--<script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>-->
    <script src="//unpkg.com/d3-geo-projection"></script>
    <script src='//unpkg.com/simple-statistics'></script>

    <!-- Data -->
    <script src="contact_tracing_apps_sentiment_analysis/data/sa_general_info.js"></script>
    <script src="contact_tracing_apps_sentiment_analysis/data/data_table.js"></script>
    <script src="contact_tracing_apps_sentiment_analysis/data/geo_data.js"></script>
    <script src="contact_tracing_apps_sentiment_analysis/data/plot_timeline_charts.js"></script>
    <script src="contact_tracing_apps_sentiment_analysis/data/geo_sa_data.js"></script>
    <script src="contact_tracing_apps_basic_information/data/sa.js"></script>


    <!-- Generation charts-->
    <script src="contact_tracing_apps_sentiment_analysis/js/main.js"></script>
    <script src="contact_tracing_apps_sentiment_analysis/js/stacked_bar_chart.js"></script>
    <script src="contact_tracing_apps_sentiment_analysis/js/plot_chart.js"></script>
    <script src="contact_tracing_apps_sentiment_analysis/js/geo_chart.js"></script>
    <script src="contact_tracing_apps_sentiment_analysis/js/sa_sunburst.js"></script>
    <script src="contact_tracing_apps_sentiment_analysis/js/pie_chart.js"></script>

    <style>
        div.tooltip {
            position: absolute;
            text-align: center;
            width: 60px;
            height: 28px;
            padding: 2px;
            font: 12px sans-serif;
            background: lightsteelblue;
            border: 0px;
            border-radius: 8px;
            pointer-events: none;
        }

        #wrap {
            width: 1200px;
            margin: auto;
            height: 900px;

            margin-top: 10px;
        }
    </style>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-174641246-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-174641246-1');
    </script>

    <script src="contact_tracing_apps_dashboard/us.js"></script>
    <script src="contact_tracing_apps_dashboard/main.js"></script>
</head>


<body>
    <div id="wrap">
        <h3>Sentiment analysis of tweets about contact tracing apps</h3>

        <h4>Introduction</h4>

        <div>
            <p>
                We performed sentiment analysis and extraction of opinions on a dataset consisting of 
                <span id="total_tweets"></span> tweets that were collected from July 2020 to July 2021 
                (as already mentioned in the
                <a href="./index_contact_tracing_apps_basic_information.html">basic information section</a>).
            </p>

            <p>
                The sentiment analysis was performed on the following languages: 
                English, French, German, Spanish and Italian. 
                The pie chart below shows the distribution of the languages in the datasets. 
                As expected, the most popular language is English, followed by Italian and German, 
                with Spanish and French having approximately the same number of tweets. 
                The pie chart also shows the share of unclassified tweets 
                (that the standard Twitter engine was not able to identify the language of the text inside a tweet), 
                and that of other languages (i.e. a small percentage of different languages not included in our study).
            </p>
            <div id="chart_languages_content">
                <svg id="chart_languages" width="400" height="400"></svg>
            </div>

            <br /><br />
            <p>
                In order to extract negative, positive and neutral sentiments, different pre-trained BERT models 
                have been used in the five most popular languages mentioned above, with the tweet-texts 
                cleaned by removing alphanumeric characters and hyperlinks. 
                The pre-trained BERT models and the training sets used to train the classifiers are listed below.
            </p>

            <ul>
                <li><a href="https://huggingface.co/cardiffnlp/twitter-roberta-base-sentiment">English - model trained
                        on ~58M tweets</a></li>
                <li><a href="https://github.com/TheophileBlard/french-sentiment-analysis-with-bert">French - model
                        trained with 100k positive tweets and 100k negative tweets</a></li>
                <li><a href="https://huggingface.co/oliverguhr/german-sentiment-bert#how-to-use">German - the training
                        data contains texts dorm different domains like Twitter, facebook and reviews</a></li>
                <li><a href="https://huggingface.co/neuraly/bert-base-italian-cased-sentiment">Italian - model trained
                        with 45k tweets</a></li>
                <li><a href="https://huggingface.co/finiteautomata/beto-sentiment-analysis">Spanish - model trained with
                        ~5k tweets</a></li>
            </ul>


            <p>
                In details, the <span id="neutral_tweets_relative"></span>% of tweets are classified without
                opinions (<span id="neutral_tweets"></span> tweets) and labeled as <em>Neutral tweets</em>.

                <span id="no_classified_tweets_relative"></span>% of the tweets have been excluded from our analysis because 
                either the language detected is not among the languages we take into account for the analysis 
                (<span id="others_tweet"></span> tweets)
                or the Twitter engine for language classification is not able to detect the languages
                (<span id="undefined_tweet"></span> tweets).

                The tweets with opinions are the <spam id="with_opinions"></spam>% where around three-quarters are
                negative teewts
                (<spam id="negative_tweets"></spam> tweets) and one-quarter positive tweets 
                (<spam id="positve_tweets"></spam> tweets).
            </p>



        </div>
        <p>
            The table below shows the tweet classification by sentiment for each contact tracing app. 
            On average, the neutral tweets are half of the total tweets for each app, except for Immuni with 65% and StopCovid with 14%.
        </p>

        <p>
            Except for Erouska and Smittestopp, the number of positive tweets is less from the negative 
            tweets for the rest of the contact tracing apps. Furthermore, the percentage of positive 
            tweets does not exceed 20%, with the exception of the (French) mobile app StopCovid, with 37% positive tweets.
        </p>

        <p>
            Negative tweets are predominant except for Erouska and Smittestopp, with the ratio between positive and negative 
            tweets to be less than 0.5 for some apps, thus indicating very negative opinions.
        </p>

        <div style="margin-top: 10px;">
            <table id="sa_table"></table>
        </div>
        <div>
            <div id="chart_1_content">
                <svg id="chart_1" width="1300" height="550"></svg>
            </div>

            <p>
                The above stacked barchart shows the distribution of the tweets collected about the 
                european contact tracing apps that have been classified as neutral, positive and negative. 
                On average, the number of negative tweets is much greater than that of positive tweets 
                except for the French mobile apps where the ratio of positive and negative tweets is 1.
            </p>

        </div>



        <div id="basic_information_sa_starbust">
            <h4>Geographical distribution of sentiments and opinions</h4>

            <p>
                We analyse here the sentiments and opinions taking into account geographical and temporal information, 
                starting with the mobile apps that refer to specific countries, like the NHS covid-19 app for UK, Immuni 
                for Italy and continuing with for the rest of mobile apps. However, we have detected a subset of tweets 
                which mention two or more mobile apps but the size of this dataset is very low with respect to the whole dataset. 
                Consequently, we developed the following hierarchical chart which shows how the twitter users think in general 
                about the covid-19 contact tracing apps in each country. The hierarchical chart shows that in general 
                the users are negative, except for the the ones from UK and France.
            </p>
            <svg id="basic_information_sa_starbust_svg" width="800" height="500"></svg>


            <p>

                As already mentioned in the basic information section, place names have been extracted from the tweet-texts. Thus, we have combined the geographic and sentiment analysis by filtering the dataset and obtaining only geo-sentiment tweets. 
                We have detected
                <span id="geo_sentiment_tweets"></span> tweets where the tweet-text contains almost one place name and an opinion. 
                We have taken into account only the geo-sentiment tweets in Europe, which are  <span id="europe_geo_sentiment_tweets"></span>.
            </p>
            <p>

                The following maps show the geographical distribution of geo-sentiment tweets. For each hex-grid, 
                the intensity of the background colour represents the number of tweets detected in its area. 
                Also, a double vertical bar chart is displayed, where the blue bar represents the positive 
                tweets and the red the negative tweets. We observe that in most of the countries there is 
                high activity on tweeter in the capital, as is the case for Paris, London, Dublin and Madrid. 
                We notice, though, a different pattern in Italy and Germany, where the number of tweets is 
                distributed more homogeneously.

            </p>
            <div id="chart_4_content">
                <svg id="chart_4" width="1300" height="1200"></svg>
            </div>

        </div>

        <h4>Temporal evolution of positive and negative tweets</h4>

        <p>
            The chart below shows the trend of positive and negative tweets from July 2020 to July 2021. 
            We notice a differentiation in sentiment polarisation in the opinions expressed in tweets during 
            October and November 2020 that could be related to the covid-19 second wave. On September 24th 
            we have the most positive day with 2076 positive tweets, with the most negative day being October 
            12th with 2005 negative tweets. After December we have a flattening activity of positive tweets 
            until the end of April, when the users start again to publish positive tweets. On the other hand, 
            the trend of negative tweets is quite active, with some negative days until June. More details about 
            specific events are provided in the event section.
        </p>
        

        <svg id="chart_plot" width="1300" height="800"></svg>

        <h4>Hashtag network: Positive vs Negative</h4>

        The hashtag network can help to understand the relations between entities, detecting communities and can 
        assist other types of analysis as was already mentioned in the section hashtags network. 
        We developed a new type of network combining the properties of the hashtag network and sentiment analysis. 
        A hashtag node in the network has a related set of tweets which can contain opinions. 
        Therefore, a node might have a sentiment orientation depending on the number of positive and 
        negative tweets. For example, the hastag <em>covid</em> has 12593 negative tweets and 8099 positive tweets, 
        hence, it seems that is quite negative. However, a tweet has several properties which explain its relevance. 
        For example, whether a tweet has been published by an authoritative user (public entity, newspaper) or 
        how many times it is retweeted/shared. For our analysis, we take into account the number of retweets 
        to obtain weighted tweets with opinions. In particular, we developed a sentiment index that summarises 
        the sentiment orientation of a hashtag. 
        Firstly, the weighted tweet value for each tweet is calculated following the formula: <br />

        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <mi>weighted-sentiment</mi>
            <mo>=</mo>
            <mmultiscripts>
                <mi>score</mi>
                <mn>sent</mn>
            </mmultiscripts>
            <mo>(</mo>
            <mi>retweets</mi>
            <mo>+</mo>
            <mi>1</mi>
            <mo>)</mo>
        </math>


        <p>
            where
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mmultiscripts>
                    <mi>score</mi>
                    <mn>sent</mn>
                </mmultiscripts>
            </math>
            in normalized beetween [0,1] and the <em>sent</em> can be 0 or 1, which detonote,
            respectly, a negative tweet <em>sent=0</em> or positive tweet when<em>sent=1</em>.
        </p>


        <p>
            Secondly, we have normalized the weighted tweets by the following formula:
            <br /><br />
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mfrac>
                    <mrow>
                        <munderover>
                            <mo>&#x2211;</mo>
                            <mrow>
                                <mi>x</mi>
                                <mo>=</mo>
                                <mi>0</mi>
                            </mrow>
                            <mi>p</mi>
                        </munderover>
                        <mrow>
                            <mmultiscripts>
                                <mi>weighted-sentiment</mi>
                                <mn>positve</mn>
                            </mmultiscripts>
                        </mrow>

                        <mo>-</mo>

                        <munderover>
                            <mo>&#x2211;</mo>
                            <mrow>
                                <mi>x</mi>
                                <mo>=</mo>
                                <mi>0</mi>
                            </mrow>
                            <mi>n</mi>
                        </munderover>
                        <mrow>
                            <mmultiscripts>
                                <mi>weighted-sentiment</mi>
                                <mn>negative</mn>
                            </mmultiscripts>
                        </mrow>

                    </mrow>

                    <mrow>
                        <munderover>
                            <mo>&#x2211;</mo>
                            <mrow>
                                <mi>x</mi>
                                <mo>=</mo>
                                <mi>0</mi>
                            </mrow>
                            <mi>p</mi>
                        </munderover>
                        <mrow>
                            <mmultiscripts>
                                <mi>weighted-sentiment</mi>
                                <mn>positve</mn>
                            </mmultiscripts>
                        </mrow>

                        <mo>+</mo>

                        <munderover>
                            <mo>&#x2211;</mo>
                            <mrow>
                                <mi>x</mi>
                                <mo>=</mo>
                                <mi>0</mi>
                            </mrow>
                            <mi>n</mi>
                        </munderover>
                        <mrow>
                            <mmultiscripts>
                                <mi>weighted-sentiment</mi>
                                <mn>negative</mn>
                            </mmultiscripts>
                        </mrow>
                    </mrow>

                </mfrac>
            </math>
            where <em>p</em> and <em>n</em> are respectively the number of positive and negative tweets regarding hashtag.
        </p>

        <p>
            Finally, by applying the above formula to each hashtag, we can calculate the hashtag orientation, 
            which is between the values -1 and 1, where 1 is highly positive and -1 highly negative respectively. 
            We consider the 0 value not as neutral but only as an equal distribution of positive and negative opinions.
        </p>

        <p>
            The image below shows sentiment hashtag network. The blue nodes are positive hashtags and the red nodes 
            are negative hashtags. The size of the node is proportional to the <em>sentiment index</em>.
            Thus, in the large nodes the orientation is strongly positive or negative, depending on the colour 
            of the node. Small nodes, in the center of the network, have weak orientation, with an equal 
            number of positive and negative tweets. Furthermore, the network was pruned by removing the nodes 
            with a low degree and the neutral tweets were ignored.
        </p>
        <img src="contact_tracing_apps_sentiment_analysis/data/sa_network_2.png" />
        <!--
        <img src="contact_tracing_apps_sentiment_analysis/data/sa_network_1.png" />
            -->
    </div>
</body>

</html>

<!-- https://stackoverflow.com/questions/50478133/d3js-export-svg-to-image -->